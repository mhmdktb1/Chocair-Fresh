# ğŸ“Š Recommendation System - Architecture Diagram

## System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      CHOCAIR FRESH BACKEND                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              RECOMMENDATION SYSTEM                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ LAYER 1: KNOWLEDGE EXTRACTION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  MongoDB Orders Collection                                â”‚  â”‚
â”‚  â”‚         â”‚                                                  â”‚  â”‚
â”‚  â”‚         â–¼                                                  â”‚  â”‚
â”‚  â”‚  [ buildProductAssociations.js ]                          â”‚  â”‚
â”‚  â”‚     â”‚                                                      â”‚  â”‚
â”‚  â”‚     â”œâ”€â–º Analyzes order items                              â”‚  â”‚
â”‚  â”‚     â”œâ”€â–º Finds product pairs                               â”‚  â”‚
â”‚  â”‚     â””â”€â–º Counts co-occurrences                             â”‚  â”‚
â”‚  â”‚         â”‚                                                  â”‚  â”‚
â”‚  â”‚         â–¼                                                  â”‚  â”‚
â”‚  â”‚  product-associations.json                                â”‚  â”‚
â”‚  â”‚  { "tomato_id": { "onion_id": 14, "lemon_id": 9 } }      â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  MongoDB Orders Collection                                â”‚  â”‚
â”‚  â”‚         â”‚                                                  â”‚  â”‚
â”‚  â”‚         â–¼                                                  â”‚  â”‚
â”‚  â”‚  [ buildProductPopularity.js ]                            â”‚  â”‚
â”‚  â”‚     â”‚                                                      â”‚  â”‚
â”‚  â”‚     â”œâ”€â–º Counts product sales                              â”‚  â”‚
â”‚  â”‚     â”œâ”€â–º Tracks quantities                                 â”‚  â”‚
â”‚  â”‚     â””â”€â–º Ranks by popularity                               â”‚  â”‚
â”‚  â”‚         â”‚                                                  â”‚  â”‚
â”‚  â”‚         â–¼                                                  â”‚  â”‚
â”‚  â”‚  product-popularity.json                                  â”‚  â”‚
â”‚  â”‚  { "apple_id": 120, "banana_id": 98 }                    â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ LAYER 2: RECOMMENDATION ENGINE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  [ recommendationEngine.js ]                              â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  1. Load Knowledge Maps                                   â”‚  â”‚
â”‚  â”‚     â”‚                                                      â”‚  â”‚
â”‚  â”‚     â”œâ”€â–º product-associations.json                         â”‚  â”‚
â”‚  â”‚     â”œâ”€â–º product-popularity.json                           â”‚  â”‚
â”‚  â”‚     â””â”€â–º product-names.json                                â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  2. Build Candidate List                                  â”‚  â”‚
â”‚  â”‚     â”‚                                                      â”‚  â”‚
â”‚  â”‚     â””â”€â–º Find products associated with input               â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  3. Calculate Scores                                      â”‚  â”‚
â”‚  â”‚     â”‚                                                      â”‚  â”‚
â”‚  â”‚     â”œâ”€â–º Association Strength Ã— 10                         â”‚  â”‚
â”‚  â”‚     â”œâ”€â–º + Popularity Bonus (log)                          â”‚  â”‚
â”‚  â”‚     â””â”€â–º = Total Score                                     â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  4. Rank & Return                                         â”‚  â”‚
â”‚  â”‚     â”‚                                                      â”‚  â”‚
â”‚  â”‚     â””â”€â–º Sort by score (highest first)                     â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  5. Fallback Strategy                                     â”‚  â”‚
â”‚  â”‚     â”‚                                                      â”‚  â”‚
â”‚  â”‚     â””â”€â–º If no associations â†’ return popular products      â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ LAYER 3: API LAYER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  POST /api/recommend/product                              â”‚  â”‚
â”‚  â”‚    â”‚                                                       â”‚  â”‚
â”‚  â”‚    â”œâ”€â–º Validate input (productId)                         â”‚  â”‚
â”‚  â”‚    â”œâ”€â–º Call recommendation engine                         â”‚  â”‚
â”‚  â”‚    â”œâ”€â–º Enrich with product details                        â”‚  â”‚
â”‚  â”‚    â””â”€â–º Return JSON response                               â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  GET /api/recommend/trending                              â”‚  â”‚
â”‚  â”‚    â”‚                                                       â”‚  â”‚
â”‚  â”‚    â”œâ”€â–º Get top popular products                           â”‚  â”‚
â”‚  â”‚    â”œâ”€â–º Enrich with product details                        â”‚  â”‚
â”‚  â”‚    â””â”€â–º Return JSON response                               â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  POST /api/recommend/refresh                              â”‚  â”‚
â”‚  â”‚    â”‚                                                       â”‚  â”‚
â”‚  â”‚    â””â”€â–º Reload knowledge maps from disk                    â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  GET /api/recommend/status                                â”‚  â”‚
â”‚  â”‚    â”‚                                                       â”‚  â”‚
â”‚  â”‚    â””â”€â–º Check if knowledge maps exist                      â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Data Flow Diagram

### 1ï¸âƒ£ Knowledge Building Phase (One-time / Periodic)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MongoDB  â”‚
â”‚ Orders   â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Build Scripts     â”‚
â”‚  (run weekly)      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ associations     â”‚
â”‚ â€¢ popularity       â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Knowledge Maps    â”‚
â”‚  (JSON files)      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ associations.jsonâ”‚
â”‚ â€¢ popularity.json  â”‚
â”‚ â€¢ names.json       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2ï¸âƒ£ Recommendation Phase (Real-time)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Frontend â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚ POST /api/recommend/product
     â”‚ { productId: "123", limit: 5 }
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ API Controller     â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Engine             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. Load knowledge  â”‚
â”‚ 2. Find candidates â”‚
â”‚ 3. Calculate scoresâ”‚
â”‚ 4. Rank products   â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Enrich with DB     â”‚
â”‚ product details    â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ JSON Response      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [                  â”‚
â”‚   {                â”‚
â”‚     product: {...},â”‚
â”‚     score: 156.3,  â”‚
â”‚     popularity: 87 â”‚
â”‚   }                â”‚
â”‚ ]                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Scoring Algorithm Visualization

```
Input Product: Tomato (ID: 507f1f77bcf86cd799439011)

Step 1: Find Associations
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ product-associations.json       â”‚
â”‚ {                               â”‚
â”‚   "tomato_id": {                â”‚
â”‚     "onion_id": 14,  â† appears  â”‚
â”‚     "lemon_id": 9,      togetherâ”‚
â”‚     "garlic_id": 6      X times â”‚
â”‚   }                             â”‚
â”‚ }                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Step 2: Calculate Scores

Onion:
  Association = 14
  Popularity = 87
  Score = (14 Ã— 10) + log(87+1) Ã— 2
        = 140 + 8.9
        = 148.9 â­â­â­â­â­

Lemon:
  Association = 9
  Popularity = 45
  Score = (9 Ã— 10) + log(45+1) Ã— 2
        = 90 + 7.6
        = 97.6 â­â­â­â­

Garlic:
  Association = 6
  Popularity = 120
  Score = (6 Ã— 10) + log(120+1) Ã— 2
        = 60 + 9.6
        = 69.6 â­â­â­

Step 3: Rank & Return
1. Onion (148.9)
2. Lemon (97.6)
3. Garlic (69.6)
```

---

## System State Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Initial State   â”‚
â”‚ (No Knowledge)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ npm run recommend:build
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Building State  â”‚
â”‚ (Extracting)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ready State     â”‚
â”‚ (Operational)   â”‚â—„â”€â”€â”€â”€â”€â”
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
         â”‚               â”‚
         â”‚ API calls     â”‚
         â–¼               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚ Serving State   â”‚      â”‚
â”‚ (Recommending)  â”‚      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
         â”‚               â”‚
         â”‚ refresh       â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Component Interaction Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Server.js  â”‚
â”‚              â”‚
â”‚  app.use(    â”‚
â”‚   '/api/     â”‚
â”‚   recommend',â”‚
â”‚   routes     â”‚
â”‚  )           â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ recommendationRouâ”‚tes.js
â”‚                  â”‚
â”‚ router.post(     â”‚
â”‚   '/product',    â”‚
â”‚   controller     â”‚
â”‚ )                â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ recommendation   â”‚
â”‚ Controller.js    â”‚
â”‚                  â”‚
â”‚ - validate input â”‚
â”‚ - call engine    â”‚
â”‚ - enrich data    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ recommendation   â”‚
â”‚ Engine.js        â”‚
â”‚                  â”‚
â”‚ - load knowledge â”‚
â”‚ - calculate      â”‚
â”‚ - rank           â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Knowledge Maps   â”‚
â”‚ (JSON)           â”‚
â”‚                  â”‚
â”‚ - associations   â”‚
â”‚ - popularity     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Lifecycle Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        SYSTEM LIFECYCLE                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

SETUP PHASE (Once):
  1. Install dependencies
  2. Configure environment
  3. Run server

KNOWLEDGE BUILDING (Weekly/Monthly):
  1. Orders accumulate
  2. Run: npm run recommend:build
  3. Knowledge maps generated
  4. System ready

OPERATION PHASE (Continuous):
  1. User views product
  2. Frontend calls API
  3. Engine recommends
  4. User sees "You might like..."

MAINTENANCE PHASE (Periodic):
  1. Rebuild knowledge
  2. Call /refresh endpoint
  3. System updated with latest data
```

---

## Summary

This visualization shows:
- âœ… 3-layer architecture (Extract â†’ Engine â†’ API)
- âœ… Data flows from Orders to Recommendations
- âœ… Scoring algorithm details
- âœ… Component interactions
- âœ… System lifecycle

**The system is modular, maintainable, and ready for ML enhancement.**
